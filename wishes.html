<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guest Wishes</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Raleway:wght@300;400&display=swap" rel="stylesheet">
    <style>
        /* Additional CSS for animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .wish-card {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin: 10px 0;
            animation: fadeIn 0.5s ease-out;
        }

        .wish-card h3 {
            color: #ff69b4;
            margin-bottom: 10px;
            font-size: 1.5em;
        }

        .wish-card p {
            color: #333;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .clear-btn {
            background-color: #ff69b4;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 20px;
        }

        .clear-btn:hover {
            background-color: #ff1493;
        }
    </style>
</head>
<body>
    
    <audio id="birthday-music" src="birthday_music.mp3" loop autoplay></audio>
    <div class="container">
        <h1 class="animate-text">Guest Wishes</h1>
        <div id="wishes-container" class="wishes-container">
            <!-- Guest messages will be dynamically added here -->
<!--         </div>
        <button id="clear-wishes-btn" class="clear-btn">Clear Wishes</button>
    </div> -->

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const wishesContainer = document.getElementById('wishes-container');

            // Function to fetch and display wishes from Google Sheets
            const loadWishes = async () => {
                try {
                    const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vRGn_ZVBKDYCK1uRH46fxon9YfxARHrEnn5m7_tUqm_diYG1zsmY6QPHAn8k5tzy-su4XU_EMYHx5ej/pub?output=csv');
                    if (!response.ok) {
                        throw new Error('Failed to load wishes');
                    }
                    const csvData = await response.text();
                    const wishes = parseCsvData(csvData); // Function to parse CSV data
                    wishesContainer.innerHTML = ''; // Clear existing wishes
                    wishes.forEach(wish => {
                        wishesContainer.appendChild(createWishElement(wish));
                    });
                } catch (error) {
                    console.error('Error loading wishes:', error.message);
                }
            };

            // Function to parse CSV data into an array of objects
            const parseCsvData = (csvData) => {
                const lines = csvData.split('\n');
                const headers = lines[0].split(',');
                const wishes = [];
                for (let i = 1; i < lines.length; i++) {
                    const data = lines[i].split(',');
                    if (data.length === headers.length) {
                        const wish = {};
                        for (let j = 0; j < headers.length; j++) {
                            wish[headers[j].trim()] = data[j].trim();
                        }
                        wishes.push(wish);
                    }
                }
                return wishes;
            };

            // Function to create a wish element
            const createWishElement = (wish) => {
                const div = document.createElement('div');
                div.className = 'wish-card';
                div.innerHTML = `
                    <h3>${wish.Name}</h3>
                    <p>${wish.Message}</p>
                `;
                return div;
            };

            // Load wishes when the page loads
            await loadWishes();

            // Clear wishes function
            const clearWishes = () => {
                wishesContainer.innerHTML = ''; // Clear HTML content
                // Optionally: You can also add code to clear data from Google Sheets here
                // Note: Directly manipulating Google Sheets data requires additional API integration
            };

            // Event listener for the clear wishes button
            document.getElementById('clear-wishes-btn').addEventListener('click', clearWishes);
        });
    </script>
</body>
</html>
